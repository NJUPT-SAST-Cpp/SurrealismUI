/**
* ============================================
* @author:syf20020816@outlook.com
* @since:20230912
* @version:0.1.1
* @type:interface
* @description:
* # SCollection
* SCollection is a grid storage box, but in reality it is not based on grid layout.
* It achieves a flexible grid through a combination of dual for loops and horizontal and vertical layouts
* Clicking on the pop-up layer again will close it
* ## properties (card)
* - in property <length> font-size : font size
* - in property <int> column-num : column number
* - in property <int> row-num : row number
* - in-out property <[[CollectionData]]> data : collection data , this is the real data!
* - in property <length> row-height : row height
* - in property <length> column-width : column width
* - in property <length> row-spaceing : row spaceing
* - in property <length> column-spacing: column spacing
* ## functions
* ## callbacks
* - clicked(CollectionData) : run if you click item in SCollection
* ============================================
*/
import { SCard } from "../card/index.slint";
import { ROOT_STYLES} from "../../themes/index.slint";
import { ScrollView } from "std-widgets.slint";
import { SText } from "../text/index.slint";
import { Themes,BorderType,UseSurrealismFn } from "../../use/index.slint";

export struct CollectionData {
  id:int,
  name:string,
  source:image
}


export component Collection inherits SCard { 
  border-type: BorderType.None;
  in property <int> column-num : 4;
  in property <int> row-num : 3;
  in-out property <[[CollectionData]]> data;
  in property <length> row-height : (root.card-height - 14px - row-spaceing * (row-num - 1)) / row-num;
  in property <length> column-width : (root.card-width - 14px - column-spacing * (column-num - 1)) / column-num;
  in property <length> row-spaceing :8px;
  in property <length> column-spacing: UseSurrealismFn.get-space(self.width) ;
  callback clicked(CollectionData);
  ScrollView { 
    height: root.card-height;
    width: root.card-width;
    viewport-width: root.card-width;
    padding: 0;
    VerticalLayout {
      width: parent.width;
      spacing: root.row-spaceing;
      padding: 0;
      for row in data: HorizontalLayout{
        height: row-height;
        width: parent.width;
        spacing: column-spacing;
        for col in row: Rectangle {
          height: parent.height;
          width: column-width;  
          background: transparent;
          TouchArea {
            clicked => {
              root.clicked(col);
            }
          }
          VerticalLayout {
            height: parent.height;
            width: parent.width;
            spacing: 2px;
            icon:=Image {
              source: col.source;
            }
            item-name:=SText { 
              theme: root.theme;
              text:col.name;
              font-size: root.font-size;
            }
          }
        }
      }
    }
  }
}